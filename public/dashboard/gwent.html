<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Document</title>
  </head>
  <body class="gwent">
    


    <aside>
      <div class="player">
        <div class="div-card-leader">
        <img src="../assets/Gwent-Cards/foltest-gwent.webp" alt="" />
      </div>
      <div class="box-oponent">
        <div class="img-oponent"><img src="../assets/icon/geralt-icon.jpg" alt=""></div>
        <div class="text-oponent">
          <p>Oponente</p>
          <p>Northern Realms</p>
        </div>
        <div class="features-oponent">
          <p>1</p>
          <div class="life-oponent"></div>
          <div class="points-oponent"></div>
        </div>
      </div>
      </div>

      <!--  
      <div class="player">
        <div class="div-card-leader">
        <img src="../assets/Gwent-Cards/foltest-gwent.webp" alt="" />
      </div>
      <div class="box-player">
        <div class="img-player"></div>
        <div class="text-oponent">
          <p>Jogador</p>
          <p>Northern Realms</p>
        </div>
        <div class="features-player">
          <p>1</p>
          <div class="life-oponent"></div>
          <div class="points-oponent"></div>
        </div>
      </div>
      </div>
      -->
    </aside>
  

    <div class="container-table">
      <div id="div_exibir_ad" class="box-cartas-adversario"></div>
      <div id="div_table_artillery" class="table-artillery">
        <h5>Artilharia</h5>
      </div>
      <div id="div_exibir_tg" class="table-gwent"></div>
      <div id="div_exibir_jv" class="box-cartas-jogador"></div>
    </div>
  </body>
</html>
<script>
  maoJogador = [];
  campoDeBatalha = [];
  maoAdversario = [];
  nomeCarta = [];
  descricaoCarta = [];
  ataqueCarta = [];
  pontuacaoJogador = [];
  pontuacaoAdversario = [];
  var mensagem_ad = "";
  var mensagem_jv = "";
  const cartas = [
    // [ Nome Completo, ATK, Caminho da Imagem ]
    ["Geralt de Rivia", 15, "../assets/Gwent-Cards/geralt-gwent.webp"],
    ["Cirila Fiona Elen Riannon", 15, "../assets/Gwent-Cards/ciri-gwent.png"],
    ["Yennefer de Vengerberg", 7, "../assets/Gwent-Cards/yennefer-gwent.png"],
    ["Triss Merigold", 7, "../assets/Gwent-Cards/triss-gwent.webp"],
    ["Foltest, O Ardente", 10, "../assets/Gwent-Cards/foltest-gwent.webp"],

    ["Ves", 5, "../assets/Gwent-Cards/ves-gwent.png"],
    ["Schirru", 5, "../assets/Gwent-Cards/schirru-gwent.webp"],
    ["Milva", 5, "../assets/Gwent-Cards/milva-gwent.webp"],
    ["Keira Metz", 5, "../assets/Gwent-Cards/keira-gwent.webp"],
    ["Cynthia", 4, "../assets/Gwent-Cards/cynthia-gwent.webp"],

    ["Redanian Foot Soldier", 1, "../assets/Gwent-Cards/redanian-gwent.webp"],
    ["Black Infantry Archer", 10, "../assets/Gwent-Cards/infantry-gwent.webp"],
    [
      "Impéria Brigade Guard",
      3,
      "../assets/Gwent-Cards/impera-guard-gwent.webp",
    ],
    ["Don Banner Medic", 5, "../assets/Gwent-Cards/medic-gwent.webp"],

    ["Balista", 6, "../assets/Gwent-Cards/balista-gwent.webp"],
    ["Trebuchet", 6, "../assets/Gwent-Cards/trebuchet.webp"],

    // Repetindo algumas unidades para garantir 20 cartas iniciais.
    ["Unidade de Suporte", 4, "../assets/Gwent-Cards/mysterious-gwent.webp"],
    ["Espiã Oculta", 0, "../assets/Gwent-Cards/mysterious-gwent.webp"],
    ["Soldado Auxiliar I", 1, "../assets/Gwent-Cards/redanian-gwent.webp"],
    ["Soldado Auxiliar II", 1, "../assets/Gwent-Cards/redanian-gwent.webp"],
  ];

  function inicializarJogo() {
    maoJogador = [];
    campoDeBatalha = [];
    maoAdversario = [];

    var baralhoCompleto = [
      // [ Nome Completo, ATK, Caminho da Imagem ]
      ["Geralt de Rivia", 15, "../assets/Gwent-Cards/geralt-gwent.webp"],
      ["Cirila Fiona Elen Riannon", 15, "../assets/Gwent-Cards/ciri-gwent.png"],
      ["Yennefer de Vengerberg", 7, "../assets/Gwent-Cards/yennefer-gwent.png"],
      ["Triss Merigold", 7, "../assets/Gwent-Cards/triss-gwent.webp"],
      ["Foltest, O Ardente", 10, "../assets/Gwent-Cards/foltest-gwent.webp"],

      ["Ves", 5, "../assets/Gwent-Cards/ves-gwent.png"],
      ["Schirru", 5, "../assets/Gwent-Cards/schirru-gwent.webp"],
      ["Milva", 5, "../assets/Gwent-Cards/milva-gwent.webp"],
      ["Keira Metz", 5, "../assets/Gwent-Cards/keira-gwent.webp"],
      ["Cynthia", 4, "../assets/Gwent-Cards/cynthia-gwent.webp"],

      ["Redanian Foot Soldier", 1, "../assets/Gwent-Cards/redanian-gwent.webp"],
      [
        "Black Infantry Archer",
        10,
        "../assets/Gwent-Cards/infanrty-gwent.webp",
      ],
      [
        "Impéria Brigade Guard",
        3,
        "../assets/Gwent-Cards/impera-guard-gwent.webp",
      ],
      ["Don Banner Medic", 5, "../assets/Gwent-Cards/medic-gwent.webp"],

      ["Balista", 6, "../assets/Gwent-Cards/balista-gwent.webp"],
      ["Trebuchet", 6, "../assets/Gwent-Cards/trebuchet.webp"],

      // Repetindo algumas unidades para garantir 20 cartas iniciais.
      ["Unidade de Suporte", 4, "../assets/Gwent-Cards/mysterious-gwent.webp"],
      ["Espiã Oculta", 0, "../assets/Gwent-Cards/mysterious-gwent.webp"],
      ["Soldado Auxiliar I", 1, "../assets/Gwent-Cards/redanian-gwent.webp"],
      ["Soldado Auxiliar II", 1, "../assets/Gwent-Cards/redanian-gwent.webp"],
    ];
    //recebe o baralho como parametro e usa na funçao embaralhar
    embaralhar(baralhoCompleto);

    //O ponto de corte é metade do baralho
    const pontoCorte = baralhoCompleto.length / 2;

    //distribuindo as cartas de fortma aleatória, a mao do jogador começa com 10
    maoJogador = baralhoCompleto.slice(0, pontoCorte);
    //mesma coisa mas ele pega o restante
    maoAdversario = baralhoCompleto.slice(pontoCorte);

    percorrerAdversario();
    percorrerJogador();
    atualizarCampoBatalha();
    calcularPontuacaoTotal();

    div_exibir_tg.innerHTML =
      '<p style="color: #ccc;">Cartas jogadas aparecerão aqui.</p>';
    alert(
      "O jogo foi iniciado! Jogue sua primeira carta e as cartas embaralhadas."
    );
  }

  //embaralha o vetor
  function embaralhar(vetor) {
    var indiceAtual = vetor.length;
    var valorTemporario;
    var indiceAleatorio;

    //verifica se tem mais itens para embaralhar
    while (indiceAtual != 0) {
      indiceAleatorio = Math.floor(Math.random() * indiceAtual);
      indiceAtual--;

      //faz as trocas
      valorTemporario = vetor[indiceAtual];
      vetor[indiceAtual] = vetor[indiceAleatorio];
      vetor[indiceAleatorio] = valorTemporario;
    }
    return vetor;
  }

  function jogarCartaAdversario(indice) {
    if (maoAdversario.length === 0) {
      return;
    }
    indice = indice === undefined ? 0 : indice;
    if (indice < 0 || indice >= maoAdversario.length) {
      return;
    }

    var cartaJogada = maoAdversario[indice];

    maoAdversario.splice(indice, 1); // Remove da mão
    campoDeBatalha.push(cartaJogada); // Adiciona ao campo

    percorrerAdversario(); // Atualiza a mão do adversário
    atualizarCampoBatalha();
    calcularPontuacaoTotal();
  }

  function jogarCartaJogador(indice) {
    if (indice < 0 || indice >= maoJogador.length) {
      alert("Essa carta ta inválida");
      return;
    }

    var cartaJogada = maoJogador[indice];
    var nome = cartaJogada[0];
    var ataque = cartaJogada[1];

    maoJogador.splice(indice, 1);

    campoDeBatalha.push(cartaJogada);

    //div_exibir_tg.innerHTML += `<div style="background-Color: blue;" class="card-item">${nome} (${ataque} ATK)</div>`
    atualizarCampoBatalha();
    percorrerJogador();
    calcularPontuacaoTotal();

    var indiceAdversario = Math.floor(Math.random() * maoAdversario.length);
    jogarCartaAdversario(indiceAdversario);
  }

  function atualizarCampoBatalha() {
    div_exibir_tg.innerHTML = "";
    for (let i = 0; i < campoDeBatalha.length; i++) {
      var cartaJogada = campoDeBatalha[i];
      var nome = cartaJogada[0];
      var ataque = cartaJogada[1];
      var caminhoImagem = cartaJogada[2];

      div_exibir_tg.innerHTML += `<div class="card-item campo"><img src="${caminhoImagem}" alt="${nome}"></div>`;
    }
  }

  function percorrerJogador() {
    mensagem_jv = "";

    for (let i = 0; i < maoJogador.length; i++) {
      var cartaAtual = maoJogador[i];

      var nomeCarta = cartaAtual[0];
      var ataqueCarta = cartaAtual[1];
      //var descricaoCarta = cartaAtual[2];
      //var pontuacaoJogador = cartaAtual[1];
      var caminhoImagem = cartaAtual[2];
      //para adicionar as fotinhos das cartas
      mensagem_jv += `
    <button onclick="jogarCartaJogador(${i})">
        <div class="card-item">
            <img src="${caminhoImagem}" alt="${nomeCarta}">
        </div>
    </button>
`;
    }

    div_exibir_jv.innerHTML = mensagem_jv;
  }
  function percorrerAdversario() {
    mensagem_ad = "";
    for (let i = 0; i < maoAdversario.length; i++) {
      cartaAtual = maoAdversario[i];

      nomeCarta = cartaAtual[0];
      ataqueCarta = cartaAtual[1];

      var caminhoImagem = cartaAtual[2];
      mensagem_ad += `
        <div class="card-item">
            <img src="${caminhoImagem}" alt="${nomeCarta}">
        </div>
`;
    }
    div_exibir_ad.innerHTML = `${maoAdversario.length} ` + mensagem_ad;
  }

  function calcularPontuacaoTotal() {
    var pontuacaoTotal = 0;

    for (let i = 0; i < campoDeBatalha.length; i++) {
      pontuacaoTotal += campoDeBatalha[i][1];
    }

    div_exibir_total.innerHTML = `Pontuação Total: ${pontuacaoTotal}`;
  }

  function checarFimTurno() {
    var maxRodada = 3;
  }
  inicializarJogo();
</script>
